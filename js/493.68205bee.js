"use strict";(self["webpackChunkprojekt"]=self["webpackChunkprojekt"]||[]).push([[493],{6845:function(e,t,o){o.r(t),o.d(t,{default:function(){return _}});var a=o(6768),i=o(5130),n=o(4232),r=o.p+"img/info-icon.0da9c9bf.svg";const l={class:"formbold-input-flex"},s={class:"formbold-form-label with-tooltip"},m={key:0,class:"tooltip-text"},u=["value"],c={class:"formbold-form-label with-tooltip"},d={key:0,class:"tooltip-text"},p={class:"formbold-form-label with-tooltip"},h={key:0,class:"tooltip-text"},f={class:"formbold-form-label with-tooltip"},g={key:0,class:"tooltip-text"},b={class:"formbold-form-label with-tooltip"},k={key:0,class:"tooltip-text"},D={key:0},y=["src"],L=["disabled"];function v(e,t,o,v,T,C){const w=(0,a.g2)("Tutorial");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(w),(0,a.Lk)("form",{class:"form-container",onSubmit:t[12]||(t[12]=(0,i.D$)(((...e)=>C.submitForm&&C.submitForm(...e)),["prevent"]))},[t[21]||(t[21]=(0,a.Lk)("h2",{class:"formbold-form-title"},"Baumregistrierung",-1)),(0,a.Lk)("div",l,[(0,a.Lk)("label",s,[t[13]||(t[13]=(0,a.eW)(" Baumart ")),(0,a.Lk)("img",{src:r,class:"info-icon",alt:"Info",onClick:t[0]||(t[0]=(0,i.D$)((e=>C.toggleTooltip("tree_type")),["stop"]))}),"tree_type"===T.activeTooltip?((0,a.uX)(),(0,a.CE)("span",m," Wähle die Baumart aus der Liste aus. ")):(0,a.Q3)("",!0)]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>T.formData.tree_type_id=e),class:"formbold-form-input",required:""},[t[14]||(t[14]=(0,a.Lk)("option",{value:"",disabled:""},"Bitte Baumart wählen",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(T.dropDownList,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,u)))),128))],512),[[i.u1,T.formData.tree_type_id]])]),(0,a.Lk)("label",c,[t[15]||(t[15]=(0,a.eW)(" Höhe des Baumes (m) ")),(0,a.Lk)("img",{src:r,class:"info-icon",alt:"Info",onClick:t[2]||(t[2]=(0,i.D$)((e=>C.toggleTooltip("height")),["stop"]))}),"height"===T.activeTooltip?((0,a.uX)(),(0,a.CE)("span",d," Gib die Höhe des Baums in Metern an. ")):(0,a.Q3)("",!0)]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>T.formData.measurement.height=e),placeholder:"Höhe",min:"1",type:"number",class:"formbold-form-input",required:""},null,512),[[i.Jo,T.formData.measurement.height]]),(0,a.Lk)("label",p,[t[17]||(t[17]=(0,a.eW)(" Neigung (Grad) ")),(0,a.Lk)("img",{src:r,class:"info-icon",alt:"Info",onClick:t[4]||(t[4]=(0,i.D$)((e=>C.toggleTooltip("inclination")),["stop"]))}),"inclination"===T.activeTooltip?((0,a.uX)(),(0,a.CE)("span",h,t[16]||(t[16]=[(0,a.eW)(" Trage die Neigung des Baums "),(0,a.Lk)("br",null,null,-1),(0,a.eW)(" in Grad ein (0-89). ")]))):(0,a.Q3)("",!0)]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>T.formData.measurement.inclination=e),placeholder:"Neigung",min:"0",max:"89",type:"number",class:"formbold-form-input",required:""},null,512),[[i.Jo,T.formData.measurement.inclination]]),(0,a.Lk)("label",f,[t[18]||(t[18]=(0,a.eW)(" Durchmesser des Stamms (cm) ")),(0,a.Lk)("img",{src:r,class:"info-icon",alt:"Info",onClick:t[6]||(t[6]=(0,i.D$)((e=>C.toggleTooltip("trunk")),["stop"]))}),"trunk"===T.activeTooltip?((0,a.uX)(),(0,a.CE)("span",g," Miss den Stammdurchmesser in Zentimetern auf Brusthöhe. ")):(0,a.Q3)("",!0)]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>T.formData.measurement.trunk_diameter=e),placeholder:"Durchmesser des Stamms",min:"1",type:"number",class:"formbold-form-input",required:""},null,512),[[i.Jo,T.formData.measurement.trunk_diameter]]),(0,a.Lk)("label",b,[t[19]||(t[19]=(0,a.eW)(" Notiz ")),(0,a.Lk)("img",{src:r,class:"info-icon",alt:"Info",onClick:t[8]||(t[8]=(0,i.D$)((e=>C.toggleTooltip("notes")),["stop"]))}),"notes"===T.activeTooltip?((0,a.uX)(),(0,a.CE)("span",k," Hier kannst du eine optionale Notiz zum Baum hinterlassen. ")):(0,a.Q3)("",!0)]),(0,a.bo)((0,a.Lk)("input",{class:"formbold-form-input","onUpdate:modelValue":t[9]||(t[9]=e=>T.formData.measurement.notes=e),placeholder:"Notiz"},null,512),[[i.Jo,T.formData.measurement.notes]]),(0,a.Lk)("input",{type:"file",onChange:t[10]||(t[10]=e=>C.handleFileUpload(e,0))},null,32),(0,a.Lk)("input",{type:"file",onChange:t[11]||(t[11]=e=>C.handleFileUpload(e,1))},null,32),T.location?((0,a.uX)(),(0,a.CE)("div",D,[(0,a.Lk)("iframe",{src:C.iframeUrl,style:{border:"1px solid black"}},null,8,y),t[20]||(t[20]=(0,a.Lk)("br",null,null,-1))])):(0,a.Q3)("",!0),(0,a.Lk)("button",{type:"submit",disabled:C.isDisabled},"Absenden",8,L)],32)],64)}o(4114),o(8111),o(7588),o(3579);var T=o(9228),C=o(1586),w={components:{Tutorial:C.A},data(){return{dropDownList:[],location:null,activeTooltip:null,formData:{tree_type_id:0,latitude:0,longitude:0,health_status_id:1,measurement:{height:0,inclination:0,trunk_diameter:0,notes:null},files:[]}}},computed:{iframeUrl(){const{latitude:e,longitude:t}=this.location;return`https://www.openstreetmap.org/export/embed.html?bbox=${t}%2C${e}%2C${t}%2C${e}&layer=mapnik&marker=${e}%2C${t}`},isDisabled:function(){return 0===this.formData.latitude&&0===this.formData.latitude}},methods:{toggleTooltip(e){this.activeTooltip=this.activeTooltip===e?null:e},handleClickOutside(e){const t=document.querySelectorAll(".with-tooltip"),o=Array.from(t).some((t=>t.contains(e.target)));o||(this.activeTooltip=null)},async submitForm(){const e=localStorage.getItem("token");if(!e)return localStorage.setItem("pendingTreeData",JSON.stringify(this.formData)),alert("Sie müssen sich anmelden, um einen Baum zu registrieren."),void this.$router.push("/login");try{console.log(JSON.stringify(this.formData));const t=await fetch("https://treescope.cs.hs-fulda.de/api/v1/trees/create-tree",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(this.formData)}),o=await t.json();console.log("Antwort vom Server:",o),t.ok?(alert("Baum erfolgreich registriert!"),this.resetFormData(),localStorage.removeItem("pendingTreeData")):alert("Fehler beim Registrieren des Baums: "+o.message)}catch(t){console.error("Fehler beim Senden des Formulars:",t),alert("Ein Fehler ist aufgetreten. Bitte versuchen Sie es später erneut.")}},resetFormData(){this.formData={tree_type_id:0,latitude:this.formData.latitude,longitude:this.formData.longitude,health_status_id:1,measurement:{height:0,inclination:0,trunk_diameter:0,notes:null},files:[]};const e=document.querySelectorAll('input[type="file"]');e.forEach((e=>e.value=""))},async fetchTreeTypes(){try{const e=await fetch("https://treescope.cs.hs-fulda.de/api/v1/trees/types",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}});e.ok||console.log("Fehler beim Abrufen der Baumarten");const t=await e.json();console.log("Baumarten vom Server:",t),this.dropDownList=t.tree_types||[]}catch(e){console.error("Fehler beim Abrufen der Baumarten:",e),this.dropDownList=[]}},async getLocation(){try{const e=await T.L.getCurrentPosition({enableHighAccuracy:!0});e.coords&&(this.location=e.coords,this.formData.latitude=Number(this.location.latitude.toFixed(6)),this.formData.longitude=Number(this.location.longitude.toFixed(6)))}catch(e){console.log("GeoLocation konnte nicht abgerufen werden:",e),alert("Standort konnte nicht bestimmt werden. Bitte versuche es erneut oder aktiviere den Standortdienst.")}},addFileInput(){this.formData.files.push({filename:"",photo_data:"",description:""})},handleFileUpload(e,t){this.addFileInput();const o=e.target.files[0];if(!o)return;const a=new FileReader;a.readAsDataURL(o),a.onload=()=>{this.formData.files[t].filename=o.name,this.formData.files[t].photo_data=a.result},a.onerror=e=>{console.error("Fehler beim Lesen der Datei:",e)}}},created(){this.getLocation(),this.fetchTreeTypes();const e=localStorage.getItem("pendingTreeData"),t=localStorage.getItem("token");e&&t&&(this.formData=JSON.parse(e),localStorage.removeItem("pendingTreeData"),this.submitForm()),document.addEventListener("click",this.handleClickOutside)},unmounted(){document.removeEventListener("click",this.handleClickOutside)}},S=o(1241);const F=(0,S.A)(w,[["render",v],["__scopeId","data-v-fc75b4c2"]]);var _=F}}]);
//# sourceMappingURL=493.68205bee.js.map